from ROOT import *
from array import array
import numpy as np
import argparse,math,os,glob,h5py
parser = argparse.ArgumentParser(description="%prog [options]", formatter_class=argparse.ArgumentDefaultsHelpFormatter)
parser.add_argument("--path", dest='path',  default="", help="path")
args = parser.parse_args()

datapaths=[]

datadir="/eos/atlas/atlascerngroupdisk/phys-exotics/jdm/dibjet/FullRUN2/LatestData/Data15"
paths=[]
for f in os.listdir(datadir):
  if "280673" in f:
    paths=paths+glob.glob(datadir+"/"+f+"/*.root")
for f in paths:
  F1=TFile(f)
  if F1.GetListOfKeys().Contains("outTree"):
    datapaths.append(f)

datadir1="/eos/atlas/atlascerngroupdisk/phys-exotics/jdm/dibjet/FullRUN2/LatestData/Data17"
paths1=[]
for f in os.listdir(datadir1):
  if "332303" in f:
    paths1=paths1+glob.glob(datadir1+"/"+f+"/*.root")
for f in paths1:
  F1=TFile(f)
  if F1.GetListOfKeys().Contains("outTree"):
    datapaths.append(f)

print datapaths

bins=[1100.0, 1133.0, 1166.0, 1200.0, 1234.0, 1269.0, 1305.0, 1341.0, 1378.0, 1416.0, 1454.0, 1493.0, 1533.0, 1573.0, 1614.0, 1656.0, 1698.0, 1741.0, 1785.0, 1830.0, 1875.0, 1921.0, 1968.0, 2016.0, 2065.0, 2114.0, 2164.0, 2215.0, 2267.0, 2320.0, 2374.0, 2429.0, 2485.0, 2542.0, 2600.0, 2659.0, 2719.0, 2780.0, 2842.0, 2905.0, 2969.0, 3034.0, 3100.0, 3167.0, 3235.0, 3305.0, 3376.0, 3448.0, 3521.0, 3596.0, 3672.0, 3749.0, 3827.0, 3907.0, 3988.0, 4070.0, 4154.0, 4239.0, 4326.0, 4414.0, 4504.0, 4595.0, 4688.0, 4782.0, 4878.0, 4975.0, 5074.0, 5175.0, 5277.0, 5381.0, 5487.0, 5595.0, 5705.0, 5817.0, 5931.0, 6047.0, 6165.0, 6285.0, 6407.0, 6531.0, 6658.0, 6787.0, 6918.0, 7052.0, 7188.0, 7326.0, 7467.0, 7610.0, 7756.0, 7904.0, 8055.0, 8208.0, 8364.0, 8523.0, 8685.0, 8850.0, 9019.0, 9191.0, 9366.0, 9544.0, 9726.0, 9911.0, 10100.0, 10292.0, 10488.0, 10688.0, 10892.0, 11100.0, 11312.0, 11528.0, 11748.0, 11972.0, 12200.0, 12432.0, 12669.0, 12910.0, 13156.0 ]
histitle="Duplicated_Events"
hist = TH1F( histitle, histitle, len(bins)-1, array('f', bins) )

EventNumber17=[495550005, 495580504, 495581432, 495655097, 495669233, 495669547, 495675691, 495693936, 495713827, 495816730, 495847039, 495847494, 495888388, 495905375, 495948188, 495976928, 495983477, 495995472, 496017577, 496022830, 496038323, 496041825, 496054670, 496100937, 496152572, 496170525, 496174621, 496237347, 496244464, 496280828, 496320280, 496346743, 496400154, 497850605, 498651705, 498985973, 499014285, 499095174, 499156096, 499159131, 499178546, 499185268, 499288808, 499316174, 499326037, 499367925, 499404403, 499404533, 499435851, 499435913, 499449546, 499459454, 499476331, 499481500, 499488553, 499514732, 499529999, 499543019, 499576231, 499586985, 499587951, 499591054, 499611745, 499612774, 499643991, 499705863, 499707796, 499735964, 499746901, 499781376, 499806834]
EventNumber15=[5556516, 5557327, 5642176, 5725405, 5876664, 5892863, 5899979, 5937275, 6003651, 6048233, 6062566, 6090440, 6150793, 6170598, 6170919, 6177201, 6182718, 6184096, 6226852, 6242965, 6280763, 6283798, 6302800, 6302877, 6349028, 6397246, 6431707, 6442689, 6450776, 6468351, 6498746, 6512100, 6515146, 6518416, 6532455, 6549752, 6580387, 6582327, 6606014, 6624835, 6625441, 6645280, 6701542, 6722051, 6736441, 6736891, 6741091, 6746423, 6771274, 6771929, 6773714, 6779665, 6784430, 6793581, 6824472, 6837140, 6844191, 6852979, 6902440, 6909258, 6911577, 6914873, 6938881, 6944611, 6975958, 7003355, 7012627, 7015049, 7018176, 7030487, 7034246, 7034456, 7052376, 7077645, 7106567, 7118497, 7123353, 7134205, 7159953, 7169430, 7204391, 7205398, 7207612, 7249984, 7252813, 7253527, 7342225, 7342406, 7343424, 7350033, 7369926, 7412634, 7458376, 7471972, 7490395, 7498850, 7509900, 7520320, 7564397, 7564499, 7574091, 7623969, 7625399, 7682724, 7692188, 7694601, 7709222, 7718619, 7726927, 7775673, 7835230, 7970267, 8028162, 8046809, 8085284, 8140870, 8144311, 8151873, 8166140, 8191432, 8240445, 8257599, 8283119, 8286622]
for File in datapaths:
  f=TFile(File)
  if "Data15" in File:
    EventNumber=EventNumber15
  if "Data17" in File:
    EventNumber=EventNumber17  
  t=f.Get("outTree")
  N=t.GetEntries()
  #t.Show(1)
  for j in range(0,N):
    t.GetEntry(j)  
    if t.eventNumber in EventNumber and t.jet_pt[0]>=420 and t.jet_pt[1]>=150 and (abs(t.jet_eta[0]-t.jet_eta[1])/2)<=0.6 and t.njet>=2 and t.mjj>=1100:
      print t.mjj,t.eventNumber
      hist.Fill(t.mjj)

outFile = TFile.Open('DuplicateCheck.root','UPDATE')
outFile.cd()
hist.Write(hist.GetName(),TObject.kOverwrite)
outFile.Close()



